# Используем Node.js 20 (меньше 20 конфликтует с vite)
FROM node:20-alpine

WORKDIR /app

# Копируем зависимости
COPY package*.json ./

# Устанавливаем зависимости
RUN npm ci --silent
RUN npm install @mui/material @emotion/react @emotion/styled

# Копируем исходный код (в dev-режиме лучше монтировать через volume, но копируем на всякий случай)
COPY . .

# Открываем порт (обычно 8080 или 3000 — зависит от шаблона Preact)
EXPOSE 8080

# Запускаем dev-сервер
# Важно: убедитесь, что dev-сервер слушает 0.0.0.0
CMD ["npm", "run", "dev"]